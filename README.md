# Final Project:网格简化和重新网格化
学号：58119212  
姓名：朱顺鑫  
## 一、项目内容  
有时候，三角形网格中的三角形数量远远超过所需要的，从而浪费了存储空间，并且会花费很多的计算时间。为了解决这个问题，我们可以简化网格，在其中找到可以使用较少三角形的区域，然后相应地简化这些区域。另外，还可以找到同一表面更好的离散表示，将网格转换为更好的表示形式，称为重新网格化。
## 二、实现方法  
本次作业使用OpenMesh的半边数据结构进行网格简化操作，使用libigl的Viewer进行网格的渲染与显示，曲面简化方法使用的是QEM（quadric Error Metrics），主要思想是基于边收缩，对每一条边可以收缩的边计算一个代价值，每次收缩价值最低的那一条边并更新相关代价值，不断迭代直到满足要求即可。
## 三、实现细节  
### 1、矩阵Q的计算  
三维空间中每个平面可以由以下方程表示：ax+by+cz+d=0;根据推导，可以得到每个面的Kp矩阵，对每个顶点，我们则近似的取其Q矩阵为其相邻平面Kp矩阵的和。
### 2、有效点对的选择  
计算出每个点的Q矩阵之后，我们进行有效点对的选择，这些点对作为收缩操作的候选。QEM方法可以对非流形进行简化，具体方法是在点对的选择中，不仅仅将边作为候选对象，而将距离足够近的两点也当作候选对象，具体来说，选择有效点对的（即收缩侯选边）的标准如下：  
2.1、(v1,v2)是原网格的一条边  
2.1、||v1-v2||<t,t是一个用户自定的阈值。  
但由于实验所用网格均为流形，我们将t设为0，这样可以省去对任意两个点求距离的操作，该操作的时间复杂度O(n2)。  
### 3、收缩目标的选择以及代价计算  
针对每一个点对(v1,v2)，其收缩后的新矩阵Q由Q=Q1+Q2 近似计算，并计算每个点的代价值cost。根据最小二乘法，计算出代价最小的收缩位置。在此步中，我们对所有候选点对计算收缩位置及代价。  
### 4、迭代过程  
我们将上一步计算出的点对与收缩点以代价为衡量标准放入一个小顶堆中，具体实现中我们使用优先级队列。每次取队首的点对，将其收缩，注意更新受影响的点对的代价，具体来说，与v1v2相关的点对均需要更新。  
